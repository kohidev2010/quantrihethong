ğŸ’» Há»† THá»NG MÃ” PHá»NG
| MÃ¡y                  | Vai trÃ²                         | Ghi chÃº                                            |
| -------------------- | ------------------------------- | -------------------------------------------------- |
| `PDC-01`             | Domain Controller (AD DS + DNS) | ÄÃ£ cÃ i Ä‘áº·t, domain: kohi.com                       |
| `MAIL-SERVER`        | Exchange Server 2019            | ÄÃ£ join domain kohi.com                            |
| `CLIENT1`, `CLIENT2` | Windows 10                      | DÃ¹ng Ä‘á»ƒ truy cáº­p Outlook Web hoáº·c cáº¥u hÃ¬nh Outlook |


ğŸš€ PHáº¦N 1: CHUáº¨N Bá»Š TRÃŠN MAIL-SERVER
âœ… BÆ°á»›c 1: CÃ i Ä‘áº·t cÃ¡c Windows Features báº±ng GUI
Má»Ÿ Server Manager trÃªn MAIL-SERVER

Click vÃ o Manage â†’ chá»n Add Roles and Features

Báº¥m Next Ä‘áº¿n khi Ä‘áº¿n má»¥c Select installation type

Chá»n Role-based or feature-based installation â†’ Next

Select a server: chá»n Ä‘Ãºng mÃ¡y MAIL-SERVER â†’ Next

Server Roles:

âœ… Tick chá»n: Web Server (IIS)
â†’ Há»™p thoáº¡i hiá»‡n ra, chá»n Add Features

Báº¥m Next

Features: Tick chá»n cÃ¡c má»¥c sau:

âœ… .NET Framework 4.8 Features

âœ… Windows Process Activation Service

.NET Environment

Configuration APIs

âœ… Media Foundation

âœ… Remote Server Administration Tools > Role Administration Tools > AD DS and AD LDS Tools



| TÃªn feature                      | CÃ³ tick khÃ´ng? | Ghi chÃº                   |
| -------------------------------- | -------------- | ------------------------- |
| **.NET Framework 4.7/4.8**       | âœ… CÃ³           | Báº¯t buá»™c                  |
| **ASP.NET 4.7/4.8**              | âœ… CÃ³           | Báº¯t buá»™c                  |
| **SMTP Server (trong Features)** | âŒ KhÃ´ng        | KhÃ´ng cáº§n, Exchange tá»± lo |
| **Web Server (IIS)**             | âœ… CÃ³           | Cáº§n cho OWA, ECP          |
| **Remote Server Admin Tools**    | âœ… CÃ³           | NÃªn cÃ³ Ä‘á»ƒ quáº£n lÃ½         |


================================================================
Báº¥m Next â†’ Install

â³ Chá» há»‡ thá»‘ng cÃ i xong â†’ Restart mÃ¡y náº¿u cÃ³ yÃªu cáº§u


=========================================================================
âœ… BÆ°á»›c 2: CÃ i Ä‘áº·t .NET Framework 4.8 (náº¿u chÆ°a cÃ³)
Truy cáº­p trang:
ğŸ‘‰ https://dotnet.microsoft.com/en-us/download/dotnet-framework/net48

Táº£i báº£n offline:

Download .NET Framework 4.8 Runtime (offline installer)
â†’ File: ndp48-x86-x64-allos-enu.exe

Click Ä‘Ãºp file â†’ chá»n:

I have read and accept â†’ Install

Äá»£i quÃ¡ trÃ¬nh cÃ i â†’ Finish

Restart mÃ¡y náº¿u cÃ³ yÃªu cáº§u



===================================================================
âœ… BÆ°á»›c 3: CÃ i Visual C++ Redistributable 2012 vÃ  2013
â¤ Visual C++ 2012 x64
Truy cáº­p: https://www.microsoft.com/en-us/download/details.aspx?id=30679

Chá»n file: vcredist_x64.exe â†’ báº¥m Next

Má»Ÿ file â†’ tick I agree â†’ Install

â¤ Visual C++ 2013 x64
Truy cáº­p: https://www.microsoft.com/en-us/download/details.aspx?id=40784

Chá»n file: vcredist_x64.exe â†’ báº¥m Next

Má»Ÿ file â†’ tick I agree â†’ Install

âœ… Sau khi cÃ i xong, kiá»ƒm tra táº¡i:
Control Panel > Programs and Features xem Ä‘Ã£ cÃ³ 2 dÃ²ng Visual C++ 2012 vÃ  2013 (x64)



===================================================================
âœ… BÆ°á»›c 4: GÃ¡n quyá»n tÃ i khoáº£n cÃ i Exchange
TrÃªn PDC-01:

Má»Ÿ Active Directory Users and Computers

TÃ¬m user administrator@kohi.com

Nháº¥n pháº£i â†’ Add to a group

GÃµ: Enterprise Admins, Schema Admins â†’ Add

â— Sau khi cÃ i Exchange xong cÃ³ thá»ƒ xÃ³a user ra khá»i cÃ¡c nhÃ³m nÃ y.



====================================================================
ğŸ“¦ PHáº¦N 2: CÃ€I Äáº¶T EXCHANGE SERVER 2019
âœ… BÆ°á»›c 1: Chuáº©n bá»‹ file ISO Exchange 2019
Táº£i táº¡i:
ğŸ‘‰ https://www.microsoft.com/en-us/download/details.aspx?id=104131

Mount file ISO (Click pháº£i â†’ Mount)

Má»Ÿ á»• Ä‘Ä©a áº£o > Cháº¡y Setup.exe

 BÆ°á»›c 2: CÃ i Ä‘áº·t báº±ng GUI
Check for updates: Chá»n Connect to the Internet and check for updates â†’ Next

Copy Setup Files â†’ Next

Introduction â†’ Next

License Agreement â†’ Accept â†’ Next

Recommended Settings: Chá»n Use recommended settings â†’ Next

Server Role Selection:

Chá»n Mailbox role

Bá» chá»n Edge Transport

Tick vÃ o: Automatically install Windows Server roles and features
â†’ Next

Installation Space and Location:

Giá»¯ máº·c Ä‘á»‹nh hoáº·c chá»n á»• Ä‘Ä©a khÃ¡c náº¿u muá»‘n â†’ Next

Malware Protection Settings:

Báº¡n cÃ³ thá»ƒ Ä‘á»ƒ Enable hoáº·c Disable

Readiness Check: Há»‡ thá»‘ng sáº½ kiá»ƒm tra Ä‘áº§y Ä‘á»§ cÃ¡c Ä‘iá»u kiá»‡n.

Náº¿u cÃ³ cáº£nh bÃ¡o hoáº·c lá»—i â†’ sá»­a theo hÆ°á»›ng dáº«n

Náº¿u OK â†’ Nháº¥n Install

Chá» khoáº£ng 20-40 phÃºt â†’ khi cÃ i xong â†’ Restart náº¿u Ä‘Æ°á»£c yÃªu cáº§u

Thiáº¿u Microsoft Unified Communications Managed API 4.0, Core Runtime 64-bit

MÃ´ táº£: Exchange yÃªu cáº§u thÆ° viá»‡n nÃ y Ä‘á»ƒ hoáº¡t Ä‘á»™ng.

CÃ¡ch xá»­ lÃ½: Táº£i vÃ  cÃ i Ä‘áº·t táº¡i Ä‘Ã¢y:
ğŸ”— https://www.microsoft.com/download/details.aspx?id=34992

Thiáº¿u 'IIS URL Rewrite Module'

MÃ´ táº£: Exchange yÃªu cáº§u IIS URL Rewrite Ä‘á»ƒ xá»­ lÃ½ cÃ¡c URL chuyá»ƒn hÆ°á»›ng vÃ  cáº¥u hÃ¬nh.

CÃ¡ch xá»­ lÃ½: Táº£i vÃ  cÃ i Ä‘áº·t táº¡i Ä‘Ã¢y:
ğŸ”— https://www.iis.net/downloads/microsoft/url-rewrite

âš ï¸ Cáº£nh bÃ¡o (Warnings):
===========================================================


ğŸ› ï¸ HÆ°á»›ng dáº«n táº¡o báº£n ghi A trong DNS (trÃªn mÃ¡y PDC-01):
Má»Ÿ Server Manager trÃªn PDC-01 (mÃ¡y Ä‘Ã£ cÃ i AD/DNS).

Chá»n Tools > DNS.

Trong DNS Manager:

Má»Ÿ rá»™ng Forward Lookup Zones.

Chá»n tÃªn domain cá»§a báº¡n (vÃ­ dá»¥: kohi.com).

Click chuá»™t pháº£i chá»n New Host (A or AAAA).

Äiá»n:

Name: mail (há»‡ thá»‘ng sáº½ hiá»ƒu lÃ  mail.kohi.com)

IP address: IP cá»§a mÃ¡y Exchange Server (vÃ­ dá»¥: 192.168.1.200)

Nháº¥n Add Host â†’ OK.

âœ… ÄÃºng rá»“i! á» bÆ°á»›c truy cáº­p giao diá»‡n quáº£n trá»‹ Exchange qua https://mail.kohi.com/ecp(trÃªn google chrome hoac edge)



=========================================================================

cÃ i Ä‘áº·t cáº¥u hÃ¬nh CERTIFICATE cho web server


BÆ°á»›c 1: Chuáº©n bá»‹ chá»©ng chá»‰ SSL
Báº¡n cÃ³ 2 lá»±a chá»n:

CÃ¡ch	Loáº¡i chá»©ng chá»‰	Má»¥c Ä‘Ã­ch
1	Tá»± kÃ½ (Self-Signed)	DÃ¹ng trong lab (dá»… bá»‹ cáº£nh bÃ¡o nhÆ°ng dÃ¹ng Ä‘Æ°á»£c)
2	CA ná»™i bá»™ (Enterprise CA)	ÄÃ£ cÃ³ CA Server trong lab (Ä‘áº£m báº£o tin cáº­y trong há»‡ thá»‘ng ná»™i bá»™)

ğŸ‘‰ Báº¡n Ä‘Ã£ cÃ³ CA ná»™i bá»™ trong domain kohi.com, nÃªn sáº½ dÃ¹ng cÃ¡ch 2 lÃ  tá»‘t nháº¥t.

BÆ°á»›c 2: Táº¡o CSR (Certificate Signing Request) tá»« Exchange Admin Center (EAC)
VÃ o trÃ¬nh duyá»‡t â†’ má»Ÿ Exchange Admin Center:
https://mail.kohi.com/ecp

ÄÄƒng nháº­p báº±ng Domain Admin.

Chá»n Servers > Certificates

Chá»n server cÃ³ tÃªn mÃ¡y mail (vÃ­ dá»¥: MAIL-SERVER)

Click â• (Add) Ä‘á»ƒ táº¡o request má»›i.

Chá»n: Create a request for a certificate from a certification authority

Nháº­p tÃªn dá»… nhá»› (VD: mail.kohi.com cert), nháº¥n Next

Táº¡i pháº§n Request a Wildcard Certificate? â†’ KhÃ´ng chá»n

Nháº­p cÃ¡c tÃªn miá»n (SANs) báº¡n muá»‘n báº£o vá»‡:

mail.kohi.com

autodiscover.kohi.com

localhost (tuá»³ chá»n)

Chá»n nÆ¡i lÆ°u file CSR â†’ VD: C:\CertRequest.req

BÆ°á»›c 3: Gá»­i CSR lÃªn CA ná»™i bá»™ Ä‘á»ƒ láº¥y file .cer
Truy cáº­p CA Web:
http://www.kohi.com/certsrv

Chá»n Request a certificate â†’ advanced certificate request

Má»Ÿ file CSR (CertRequest.req) â†’ copy ná»™i dung â†’ dÃ¡n vÃ o Ã´ yÃªu cáº§u

Chá»n Template: Web Server

Gá»­i request â†’ Download file .cer

=> import certificate(mmc) vÃ o mÃ¡y PDC-01 náº¿u cÃ i webserver trÃªn mÃ¡y nÃ y



=============================================================
thÃªm chá»©ng chá»‰ vÃ o trong website
Báº¡n Ä‘ang á»Ÿ giao diá»‡n Site Binding Ä‘á»ƒ thÃªm HTTPS cho má»™t website trÃªn IIS. Trong cá»­a sá»• â€œEdit Site Bindingâ€ cÃ³ cÃ¡c má»¥c:

Type: https (âœ… Ä‘Ãºng)

IP address: 192.168.1.28 (ğŸš« sai náº¿u IP mÃ¡y báº¡n lÃ  192.168.1.250)

Port: 443 (âœ… Ä‘Ãºng)

SSL Certificate: Ä‘Ã£ chá»n â€œssl-mailâ€ (âœ… Ä‘Ãºng, náº¿u Ä‘Ãºng chá»©ng chá»‰ cá»§a CA báº¡n cáº¥p)

=> viá»‡c thÃªm chá»©ng chá»‰ chá»‰ há»— trá»£ khi dang nháº­p tÃªn https://mail.kohi.com/ecp khÃ´ng hiá»ƒn thá»‹ mÃ u Ä‘á» chá»¯ https


